<!-- Combined Sticky Header Wrapper -->
<div class="site-sticky-header" style="position: fixed !important; top: 0 !important; left: 0 !important; right: 0 !important; z-index: 999999 !important; width: 100% !important;">
    <!-- Top Contact Bar -->
    <div class="top-contact-bar bg-brand-blue text-white py-1.5 sm:py-2.5 text-sm border-b-4 border-brand-orange overflow-hidden">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 max-w-full">
            <div class="flex flex-nowrap justify-center items-center gap-2 sm:gap-4 md:gap-8">
                <a href="tel:3012082273" class="hover:text-brand-orange transition-colors flex items-center gap-1.5 sm:gap-2 font-semibold text-xs sm:text-sm">
                    <svg class="w-4 h-4 sm:w-5 sm:h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/>
                    </svg>
                    <span class="tracking-wide whitespace-nowrap">Call: (301) 208-2273</span>
                </a>
                
                <div class="hidden sm:block w-px h-6 bg-white/30"></div>
                
                <a href="sms:3012052293" class="hover:text-brand-orange transition-colors flex items-center gap-1.5 sm:gap-2 font-semibold text-xs sm:text-sm">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 sm:h-5 sm:w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
                    </svg>
                    <span class="tracking-wide whitespace-nowrap">Text: (301) 205-2293</span>
                </a>
                
                <div class="hidden md:block w-px h-6 bg-white/30"></div>
                
                <div class="hidden md:flex items-center gap-2 font-semibold text-xs md:text-sm lg:text-base flex-shrink-0">
                    <svg class="w-4 h-4 md:w-5 md:h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                    </svg>
                    <span class="tracking-wide whitespace-nowrap text-xs md:text-sm">Mon-Thu 8am-7pm | Fri 8am-6pm | Sat/Sun 8am-1pm</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Navigation Header -->
    <header class="glass-effect">
        <div class="container mx-auto px-3 sm:px-4 lg:px-6 max-w-[1400px]">
            <nav class="main-header-nav py-3">
            <!-- Logo - Left aligned -->
            <div class="main-header-logo flex items-center flex-shrink-0 pr-6" style="position: relative; z-index: 10030;">
                <a href="#" class="flex items-center group logo-link">
                    <img
                        src="images/Logo.png"
                        alt="Montgomery Medical Clinic"
                        class="h-20 w-auto lg:h-24 object-contain transition-transform duration-200 group-hover:scale-105 logo-img"
                        loading="eager"
                        fetchpriority="high"
                        width="240"
                        height="96"
                        style="filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));"
                    />
                </a>
            </div>

            <!-- Center navigation links -->
            <div class="main-header-links hidden xl:flex items-center justify-center gap-4 xl:gap-5 flex-wrap">
                <a href="#" class="nav-link nav-home">Home</a>
                <div class="services-dropdown-wrapper relative">
                    <button class="nav-link flex items-center gap-2" id="services-button">
                        <strong>Services</strong>
                        <svg class="w-4 h-4 transition-transform" id="services-arrow" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                        </svg>
                    </button>
                    <div class="services-dropdown" id="services-dropdown">
                        <a href="#" class="dropdown-link nav-urgent">Urgent & Primary Care</a>
                        <a href="#" class="dropdown-link nav-derma">Dermatology</a>
                        <a href="#" class="dropdown-link nav-occupational">Occupational Health</a>
                        <a href="#" class="dropdown-link nav-acupuncture">Five Elements Acupuncture</a>
                        <a href="#" class="dropdown-link nav-wellness">Wellness Center</a>
                        <a href="#" class="dropdown-link nav-sports">Sports Medicine & Physical Therapy</a>
                    </div>
                </div>
                <a href="#" class="nav-link nav-about">About</a>
                <a href="#" class="nav-link nav-insurance">Insurance</a>
                <a href="#" class="nav-link contact-trigger" data-contact-trigger>Contact</a>
            </div>

            <!-- Right aligned buttons -->
            <div class="main-header-actions flex items-center gap-2 xl:gap-3 flex-shrink-0">
                <a href="https://nextpatient.co/p/montgomerymedclinic/schedule" target="_blank" class="hidden xl:inline-flex btn btn-secondary whitespace-nowrap text-sm px-4 py-2.5">
                    Request Appointment
                </a>
                <a href="https://15259-6.portal.athenahealth.com/" target="_blank" class="hidden sm:inline-flex btn btn-primary whitespace-nowrap text-sm px-4 py-2.5">
                    Patient Portal
                </a>

                <!-- Mobile Menu Button - Clean and minimal -->
                <button id="mobile-menu-btn" class="xl:hidden mobile-menu-button" aria-label="Toggle menu" aria-expanded="false">
                    <span class="hamburger-box">
                        <span class="hamburger-inner"></span>
                    </span>
                </button>
            </div>
        </nav>
        
        <!-- Mobile Menu - Minimal and clean -->
        <div id="mobile-menu" class="mobile-menu hidden">
            <div class="mobile-menu-inner">
                <a href="#" class="mobile-menu-item mobile-nav-home">Home</a>
                <a href="#" class="mobile-menu-item mobile-nav-urgent">Urgent & Primary Care</a>
                <a href="#" class="mobile-menu-item mobile-nav-derma">Dermatology</a>
                <a href="#" class="mobile-menu-item mobile-nav-occupational">Occupational Health</a>
                <a href="#" class="mobile-menu-item mobile-nav-acupuncture">Five Elements Acupuncture</a>
                <a href="#" class="mobile-menu-item mobile-nav-wellness">Wellness Center</a>
                <a href="#" class="mobile-menu-item mobile-nav-sports">Sports Medicine</a>
                <a href="#" class="mobile-menu-item mobile-nav-about">About</a>
                <a href="#" class="mobile-menu-item mobile-nav-insurance">Insurance</a>
                <a href="#" class="mobile-menu-item contact-trigger" data-contact-trigger>Contact</a>
                <a href="https://15259-6.portal.athenahealth.com/" target="_blank" class="mobile-menu-item mobile-menu-portal sm:hidden">
                    Patient Portal
                </a>
            </div>
        </div>
    </div>
</header>
</div>
<!-- End of Sticky Header Wrapper -->

<!-- Contact Modal - Simple & Compact -->
<div id="contact-modal" class="contact-modal" role="dialog" aria-modal="true" aria-labelledby="contact-modal-title">
    <div class="contact-modal-content">
        <button type="button" class="contact-close" data-contact-close aria-label="Close contact information">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"/>
            </svg>
        </button>

        <h2 id="contact-modal-title" class="contact-modal-title">Contact Montgomery Medical Clinic</h2>
        <p class="contact-intro">Reach out in the way that fits you best. Our care team responds quickly during office hours and actively monitors urgent messages after hours.</p>

        <div class="contact-modal-body">
            <!-- Contact Methods Row -->
            <div class="contact-methods-row">
                <!-- Call -->
                <a href="tel:3012082273" class="contact-item contact-method">
                    <svg class="contact-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/>
                    </svg>
                    <div class="contact-text">
                        <span class="contact-label">Call Us</span>
                        <span class="contact-value">(301) 208-2273</span>
                        <span class="contact-subtext">Speak with care coordinators</span>
                    </div>
                </a>

                <!-- Text -->
                <a href="sms:3012052293" class="contact-item contact-method">
                    <svg class="contact-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/>
                    </svg>
                    <div class="contact-text">
                        <span class="contact-label">Text Us</span>
                        <span class="contact-value">(301) 205-2293</span>
                        <span class="contact-subtext">Quick questions & updates</span>
                    </div>
                </a>

                <!-- Email -->
                <a href="mailto:providers@mmccare.com" class="contact-item contact-method">
                    <svg class="contact-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
                    </svg>
                    <div class="contact-text">
                        <span class="contact-label">Email Us</span>
                        <span class="contact-value">providers@mmccare.com</span>
                        <span class="contact-subtext">Reply within one business day</span>
                    </div>
                </a>
            </div>

            <!-- Hours & Address Row -->
            <div class="contact-info-row">
                <!-- Hours -->
                <div class="contact-item contact-info contact-hours-card">
                    <svg class="contact-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                    </svg>
                    <div class="contact-text">
                        <span class="contact-label">Office Hours</span>
                        <ul class="contact-hours-list">
                            <li><span>Mon – Thu</span><span>8 AM – 7 PM</span></li>
                            <li><span>Friday</span><span>8 AM – 6 PM</span></li>
                            <li><span>Sat/Sun</span><span>8 AM – 1 PM</span></li>
                        </ul>
                        <span class="contact-note">Live answers during hours. Urgent messages monitored 24/7.</span>
                    </div>
                </div>

                <!-- Address -->
                <a href="https://maps.apple.com/?address=800%20S%20Frederick%20Ave,%20Suite%20110,%20Gaithersburg,%20MD%20%2020877" target="_blank" rel="noopener" class="contact-item contact-address-card">
                    <svg class="contact-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
                        <path stroke-linecap="round" stroke-linejoin="round" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
                    </svg>
                    <div class="contact-text">
                        <span class="contact-label">Visit Us</span>
                        <span class="contact-value">
                            800 S Frederick Ave, Suite 110<br>
                            Gaithersburg, MD 20877
                        </span>
                        <span class="contact-directions">Get Directions →</span>
                        <span class="contact-note">Walk-ins welcome. Schedule for guaranteed same-day care.</span>
                    </div>
                </a>
            </div>
        </div>
    </div>
</div>

<script>
// CRITICAL FAILSAFE: Force header to stay fixed at all times
(function enforceFixedHeader() {
    const stickyHeader = document.querySelector('.site-sticky-header');
    if (stickyHeader) {
        // Set position fixed with !important via inline style
        stickyHeader.style.setProperty('position', 'fixed', 'important');
        stickyHeader.style.setProperty('top', '0', 'important');
        stickyHeader.style.setProperty('left', '0', 'important');
        stickyHeader.style.setProperty('right', '0', 'important');
        stickyHeader.style.setProperty('z-index', '999999', 'important');
        stickyHeader.style.setProperty('width', '100%', 'important');
        
        // Create MutationObserver to prevent any changes
        const observer = new MutationObserver(function(mutations) {
            mutations.forEach(function(mutation) {
                if (mutation.type === 'attributes' && mutation.attributeName === 'style') {
                    const currentPos = window.getComputedStyle(stickyHeader).position;
                    if (currentPos !== 'fixed') {
                        stickyHeader.style.setProperty('position', 'fixed', 'important');
                        stickyHeader.style.setProperty('top', '0', 'important');
                    }
                }
            });
        });
        
        observer.observe(stickyHeader, {
            attributes: true,
            attributeFilter: ['style', 'class']
        });
    }
})();

document.addEventListener('DOMContentLoaded', function() {
    const mobileMenuBtn = document.getElementById('mobile-menu-btn');
    const mobileMenu = document.getElementById('mobile-menu');
    const header = document.querySelector('header.glass-effect');

    // Mobile menu functionality
    if (mobileMenuBtn && mobileMenu) {
        mobileMenu.classList.add('hidden');
        mobileMenu.classList.remove('is-open');
        mobileMenuBtn.classList.remove('active');
        mobileMenuBtn.setAttribute('aria-expanded', 'false');

        const openMenu = () => {
            mobileMenu.classList.remove('hidden');
            mobileMenu.classList.add('is-open');
            document.body.classList.add('mobile-menu-open');
            mobileMenuBtn.classList.add('active');
            mobileMenuBtn.setAttribute('aria-expanded', 'true');
        };

        const closeMenu = () => {
            mobileMenu.classList.remove('is-open');
            mobileMenu.classList.add('hidden');
            document.body.classList.remove('mobile-menu-open');
            mobileMenuBtn.classList.remove('active');
            mobileMenuBtn.setAttribute('aria-expanded', 'false');
        };

        mobileMenuBtn.addEventListener('click', function(event) {
            event.preventDefault();
            event.stopPropagation();

            if (mobileMenu.classList.contains('hidden')) {
                openMenu();
            } else {
                closeMenu();
            }
        });

        mobileMenu.querySelectorAll('.mobile-menu-item').forEach(link => {
            link.addEventListener('click', () => {
                closeMenu();
            });
        });

        document.addEventListener('click', (event) => {
            const isMenuOpen = !mobileMenu.classList.contains('hidden');
            if (!isMenuOpen) {
                return;
            }

            if (mobileMenu.contains(event.target) || mobileMenuBtn.contains(event.target)) {
                return;
            }

            closeMenu();
        });

        const handleViewportReset = () => {
            if (window.innerWidth >= 1280) {
                closeMenu();
            }
        };

        window.addEventListener('resize', handleViewportReset);
        window.addEventListener('orientationchange', handleViewportReset);
    }

    // Enhanced sticky header effect: only toggle visual state
    // CRITICAL: Header must remain position: fixed at all times
    if (header) {
        const contactBar = document.querySelector('.top-contact-bar');
        let ticking = false;

        const updateHeader = () => {
            const scrollY = window.scrollY;
            const contactBarHeight = contactBar ? contactBar.offsetHeight : 56;
            if (scrollY > contactBarHeight) {
                header.classList.add('scrolled');
            } else {
                header.classList.remove('scrolled');
            }
            ticking = false;
        };

        const onScroll = () => {
            if (!ticking) {
                window.requestAnimationFrame(updateHeader);
                ticking = true;
            }
        };

        window.addEventListener('scroll', onScroll, { passive: true });
        window.addEventListener('resize', updateHeader, { passive: true });
        updateHeader();
    }

    // Contact Modal Functionality
    const contactModal = document.getElementById('contact-modal');
    const contactTriggers = document.querySelectorAll('[data-contact-trigger]');
    const contactClose = document.querySelector('[data-contact-close]');

    function openContactModal() {
        contactModal.classList.add('active');
        document.body.style.overflow = 'hidden';
    }

    function closeContactModal() {
        contactModal.classList.remove('active');
        document.body.style.overflow = '';
    }

    contactTriggers.forEach(trigger => {
        trigger.addEventListener('click', function(e) {
            e.preventDefault();
            openContactModal();
        });
    });

    if (contactClose) {
        contactClose.addEventListener('click', closeContactModal);
    }

    contactModal.addEventListener('click', function(e) {
        if (e.target === contactModal) {
            closeContactModal();
        }
    });

    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape' && contactModal.classList.contains('active')) {
            closeContactModal();
        }
    });
});
</script>
